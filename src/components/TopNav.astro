---
interface Props {
  activeTab: 'home' | 'play_ground' | 'market_fourier' | 'market_data';
}

const { activeTab } = Astro.props;

const tabs = [
  { id: 'home', label: 'HOME', href: import.meta.env.BASE_URL },
  { id: 'play_ground', label: 'FOURIER', href: `${import.meta.env.BASE_URL}/play_ground`.replace(/\/\//g, '/') }
];
---

<header id="top-header" class="fixed top-0 left-0 w-full z-30 transition-all duration-500 pt-3 md:pt-4 px-4 flex flex-col items-center gap-2 md:gap-3 pointer-events-none">
  
  <!-- ROW 1: MAIN NAVIGATION TABS -->
  <div class="max-w-fit flex items-center p-1 rounded-2xl border shadow-2xl pointer-events-auto" style="background: var(--color-bg-glass); border-color: var(--color-border-glass);">
    <nav class="flex gap-0.5">
      {tabs.map(tab => (
        <a
          href={tab.href}
          class={`px-4 md:px-6 py-2 rounded-xl text-[9px] md:text-[10px] uppercase font-black tracking-[0.2em] transition-all duration-300 ${
            activeTab === tab.id
              ? 'bg-white/10 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)] border border-white/5'
              : 'text-slate-500 hover:text-slate-300 hover:bg-white/5 border border-transparent'
          }`}
        >
          {tab.label}
        </a>
      ))}
    </nav>
  </div>

  <!-- ROW 2: COMMAND TOOLBAR (Contextual) -->
  {(activeTab === 'play_ground' || activeTab === 'market_fourier') && (
    <div class="max-w-fit flex items-center gap-2 p-1 rounded-xl border shadow-2xl pointer-events-auto" style="background: var(--color-bg-inner); border-color: var(--color-border-inner);">
      
      <!-- Mode Selection (Playground Only) -->
      {activeTab === 'play_ground' && (
        <div class="flex gap-1 pr-1 border-r border-white/10">
          <button id="mode-manual" class="btn-glass active group !p-2 !rounded-lg" title="Manual Mode">
            <svg class="w-4 h-4 text-slate-400 group-[.active]:text-emerald-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
            </svg>
          </button>
          <button id="mode-audio" class="btn-glass group !p-2 !rounded-lg" title="Audio Mode">
            <svg class="w-4 h-4 text-slate-400 group-[.active]:text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3" />
            </svg>
          </button>
          <button id="mode-auto" class="btn-glass group !p-2 !rounded-lg" title="Cinematic Mode">
            <svg class="w-4 h-4 text-slate-400 group-[.active]:text-amber-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
            </svg>
          </button>
        </div>
      )}

      <!-- Universal View Utilities -->
      <div class="flex gap-1 px-1">
        <button id="nav-2d" class="btn-glass group !p-2 !rounded-lg" title="Toggle 2D/3D">
          <svg class="w-4 h-4 text-slate-400 group-[.active]:text-emerald-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
          </svg>
        </button>
        <button id="btn-reset-cam" class="btn-glass group !p-2 !rounded-lg" title="Reset View">
          <svg class="w-4 h-4 text-slate-400 group-hover:text-cyan-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
          </svg>
        </button>
        <button id="btn-auto-orbit" class="btn-glass group !p-2 !rounded-lg" title="Auto Orbit">
          <svg class="w-4 h-4 text-slate-400 group-[.active]:text-amber-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
          </svg>
        </button>
        <button id="btn-immersive" class="btn-glass group !p-2 !rounded-lg" title="Immersive">
          <svg class="w-4 h-4 text-slate-400 group-[.active]:text-indigo-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
          </svg>
        </button>
        <button id="btn-fullscreen" class="btn-glass group !p-2 !rounded-lg" title="Fullscreen">
          <svg class="w-4 h-4 text-slate-400 group-[.active]:text-cyan-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5v-4m0 4h-4m4 0l-5-5" />
          </svg>
        </button>
      </div>
    </div>
  )}
</header>

<style is:global>
  @reference "../styles/global.css";

  .btn-glass {
    @apply transition-all duration-200 cursor-pointer flex items-center justify-center;
  }
  .btn-glass:hover {
    background-color: rgba(255, 255, 255, 0.05);
  }
  .btn-glass.active {
    background-color: rgba(255, 255, 255, 0.1);
    @apply shadow-inner;
  }
</style>
