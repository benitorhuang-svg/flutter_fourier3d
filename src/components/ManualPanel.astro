<!-- LEFT SIDE PANEL (Synthesis & Sliders) -->
<div id="panel-manual" class="absolute top-24 left-2 md:left-6 w-[180px] md:w-72 flex flex-col transition-all duration-500 z-10 pointer-events-none gap-3 md:gap-4 items-stretch max-h-[calc(100vh-160px)] md:max-h-[700px] h-auto glass-card rounded-xl md:rounded-2xl p-2 md:p-4 shadow-2xl bg-slate-900/80 md:bg-slate-900/60 backdrop-blur-xl border border-white/5">
    
    <!-- Presets Section -->
    <div class="flex flex-col gap-2 pointer-events-auto">
        <h3 class="text-[10px] md:text-xs font-black text-emerald-400 uppercase tracking-[0.2em] mb-1">Manual Synthesis</h3>
        <div id="panel-presets" class="flex flex-row items-center gap-1 w-full p-1 rounded-lg border" style="background: var(--color-bg-inner); border-color: var(--color-border-inner);">
            <button class="preset-btn active flex-1 py-1 rounded text-[7px] md:text-[9px] uppercase tracking-tighter active:scale-95 transition-all font-black" data-preset="square">Square</button>
            <button class="preset-btn flex-1 py-1 rounded text-[7px] md:text-[9px] uppercase tracking-tighter active:scale-95 transition-all font-black" data-preset="triangle">Triangle</button>
            <button class="preset-btn flex-1 py-1 rounded text-[7px] md:text-[9px] uppercase tracking-tighter active:scale-95 transition-all font-black" data-preset="pulse">Pulse</button>
        </div>
    </div>

    <!-- Quantity Box -->
    <div class="flex flex-col gap-2 pointer-events-auto">
        <div class="flex items-center justify-between rounded-lg border p-1.5 md:px-3 md:h-10" style="background: var(--color-bg-inner); border-color: var(--color-border-inner);">
            <span class="text-[7px] md:text-[10px] font-black uppercase text-slate-500 tracking-tighter md:tracking-widest">Quantity</span>
            <div class="flex items-center gap-1.5">
                <button data-action="dec" class="w-6 h-6 md:w-8 md:h-7 flex items-center justify-center rounded bg-white/5 hover:bg-white/20 active:scale-90 transition-all text-emerald-400 text-sm md:text-xl font-black">-</button>
                <div id="harmonic-count-display" class="text-[9px] md:text-xs font-mono text-emerald-400 w-6 md:w-8 text-center bg-black/20 rounded h-6 md:h-7 flex items-center justify-center border border-white/5">8</div>
                <button data-action="inc" class="w-6 h-6 md:w-8 md:h-7 flex items-center justify-center rounded bg-white/5 hover:bg-white/20 active:scale-90 transition-all text-emerald-400 text-sm md:text-xl font-black">+</button>
            </div>
            <input type="number" id="harmonic-count-input" value="8" min="1" max="60" class="hidden">
        </div>
    </div>

    <!-- Selector Column (Detail) -->
    <div class="flex flex-col gap-1 w-full flex-grow min-h-0 overflow-hidden pointer-events-auto">
        <div id="harmonic-selector" class="grid grid-cols-3 md:grid-cols-4 gap-1 md:gap-1.5 overflow-y-auto w-full custom-scrollbar pb-1 pt-1 px-0.5 flex-grow min-h-0 content-start">
            <!-- Generated tiny buttons via JavaScript -->
        </div>
    </div>

    <!-- Divider -->
    <div class="w-full h-px bg-white/10 flex-shrink-0"></div>

    <!-- Active Settings (Master) -->
    <div class="flex flex-col gap-2 md:gap-3 w-full flex-shrink-0 p-2 md:p-3 rounded-lg md:rounded-xl border pointer-events-auto" style="background: var(--color-bg-inner); border-color: var(--color-border-inner);">
        <div class="flex justify-between items-center border-b border-white/10 pb-1 mb-0.5">
            <span id="active-h-label" class="text-[8px] md:text-[10px] font-black tracking-widest text-emerald-400 uppercase">H1 Settings</span>
        </div>
        <div class="flex flex-col gap-2">
            <div class="flex flex-col gap-1.5">
                <div class="flex justify-between items-center px-0.5">
                    <span class="text-[7px] md:text-[9px] font-bold text-blue-400 tracking-wider">AMP</span>
                    <span id="master-amp-val" class="text-[8px] md:text-xs font-mono text-blue-400">0</span>
                </div>
                <input type="range" id="master-amp" min="-100" max="100" class="w-full h-1 accent-blue-500 cursor-pointer">
            </div>
            <div class="flex flex-col gap-1.5">
                <div class="flex justify-between items-center px-0.5">
                    <span class="text-[7px] md:text-[9px] font-bold text-purple-400 tracking-wider">PHI</span>
                    <span id="master-phi-val" class="text-[8px] md:text-xs font-mono text-purple-400">0.0</span>
                </div>
                <input type="range" id="master-phi" min="0" max="6.28" step="0.1" class="w-full h-1 accent-purple-500 cursor-pointer">
            </div>
        </div>
    </div>
</div>

<style is:global>
    @reference "../styles/global.css";

    .preset-btn {
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.05);
        color: #94a3b8;
    }
    .preset-btn:hover {
        background: rgba(255, 255, 255, 0.08);
        color: white;
    }
    .preset-btn.active {
        background: rgba(16, 185, 129, 0.15);
        border-color: rgba(16, 185, 129, 0.4);
        color: #10b981;
    }

    /* Harmonic Selector Buttons (Generated via JS) */
    .h-btn {
        @apply transition-all duration-200;
        background: var(--color-bg-inner) !important;
        border: 1px solid var(--color-border-inner) !important;
    }
</style>
